name: rag-bootstrap

services:
  # Загрузчик и импортер (запускается отдельно, когда инфраструктура уже поднята)
  bootstrap-loader:
    image: medphisiker/rag-backup-downloader:v001
    container_name: rag-bootstrap-loader
    # build:
    #   context: ./backup_downloader
    volumes:
      - .:/backups
      - rag_redis_data:/redis_data
      - ./backup_downloader/bootstrap_and_restore.sh:/app/bootstrap_and_restore.sh
    environment:
      - QDRANT_HOST=rag-qdrant
      - QDRANT_PORT=6333
    networks:
      - rag_network
    entrypoint: ["/bin/sh", "/app/bootstrap_and_restore.sh"]

networks:
  rag_network:
    name: rag_rag_network
    external: true

volumes:
  rag_qdrant_storage:
    external: true
  rag_redis_data:
    external: true